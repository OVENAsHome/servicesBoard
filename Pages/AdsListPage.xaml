<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    x:Class="ServicesBoard.Pages.AdsListPage"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    Title="Ð”Ð¾ÑÐºÐ° ÑƒÑÐ»ÑƒÐ³"
    BackgroundColor="{StaticResource PageBg}">

    <!-- Toolbar Ð¾ÑÑ‚Ð°Ñ‘Ñ‚ÑÑ ÐºÐ°Ðº Ð² Ñ‚Ð²Ð¾ÐµÐ¹ Ð²ÐµÑ€ÑÐ¸Ð¸ -->
    <ContentPage.ToolbarItems>
        <ToolbarItem Text="Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ" Clicked="OnAddClicked" />
        <ToolbarItem Text="ÐœÐ¾Ð¸" Order="Secondary" Clicked="OnMyAdsClicked" />
        <ToolbarItem Text="Ð˜ÑÐ¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»Ð¸" Order="Secondary" Clicked="OnPerformersClicked" />
    </ContentPage.ToolbarItems>

    <Grid Padding="12"
          RowDefinitions="Auto,Auto,*"
          RowSpacing="10">

        <!-- Ð’ÐµÑ€Ñ… Ñ„Ð¸ÐºÑ -->
        <Grid Grid.Row="0" ColumnDefinitions="*,Auto,Auto" ColumnSpacing="8">
            <Label Text="Ð­Ð»ÐµÐºÑ‚Ñ€Ð¾Ð½Ð½Ð°Ñ Ð´Ð¾ÑÐºÐ° ÑƒÑÐ»ÑƒÐ³"
                   Style="{StaticResource H1}"
                   VerticalOptions="Center" />

            <Button x:Name="LoginButton"
                    Grid.Column="1"
                    Text="Ð’Ð¾Ð¹Ñ‚Ð¸"
                    Style="{StaticResource GhostButton}"
                    Clicked="OnLoginClicked" />

            <Button Grid.Column="2"
                    Text="Ð ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ†Ð¸Ñ"
                    Style="{StaticResource PrimaryButton}"
                    Clicked="OnRegisterClicked" />
        </Grid>

        <!-- Ð¤Ð¸Ð»ÑŒÑ‚Ñ€Ñ‹ (Ñ„Ð¸ÐºÑ Ð¿Ð¾Ð´ Ð·Ð°Ð³Ð¾Ð»Ð¾Ð²ÐºÐ¾Ð¼) -->
        <Border Grid.Row="1" Style="{StaticResource Card}">
            <VerticalStackLayout Spacing="8">

                <Label Text="Ð¤Ð¸Ð»ÑŒÑ‚Ñ€Ñ‹" Style="{StaticResource H2}"/>

                <Grid ColumnDefinitions="*,*" ColumnSpacing="8">

                    <VerticalStackLayout Grid.Column="0" Spacing="4">
                        <Label Text="ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ" Style="{StaticResource MutedText}" />
                        <Border BackgroundColor="White"
                Stroke="{StaticResource BorderSoft}"
                StrokeThickness="1"
                Padding="8,0">
                            <Border.StrokeShape>
                                <RoundRectangle CornerRadius="14"/>
                            </Border.StrokeShape>

                            <Picker x:Name="CategoryFilterPicker"
                    Title="Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ"
                    TextColor="#1F1F1F"
                    TitleColor="#7A7A7A"
                    BackgroundColor="White"
                    HeightRequest="44"/>
                        </Border>
                    </VerticalStackLayout>

                    <VerticalStackLayout Grid.Column="1" Spacing="4">
                        <Label Text="Ð Ð°Ð¹Ð¾Ð½" Style="{StaticResource MutedText}" />
                        <Border BackgroundColor="White"
                Stroke="{StaticResource BorderSoft}"
                StrokeThickness="1"
                Padding="8,0">
                            <Border.StrokeShape>
                                <RoundRectangle CornerRadius="14"/>
                            </Border.StrokeShape>

                            <Picker x:Name="AreaFilterPicker"
                    Title="Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ"
                    TextColor="#1F1F1F"
                    TitleColor="#7A7A7A"
                    BackgroundColor="White"
                    HeightRequest="44"/>
                        </Border>
                    </VerticalStackLayout>

                </Grid>


                <Grid ColumnDefinitions="*,*,*" ColumnSpacing="8">
                    <VerticalStackLayout Grid.Column="0" Spacing="4">
                        <Label Text="Ð¦ÐµÐ½Ð° Ð¾Ñ‚" Style="{StaticResource MutedText}"/>
                        <Entry x:Name="MinPriceEntry" Keyboard="Numeric" Style="{StaticResource Input}" HeightRequest="44"/>
                    </VerticalStackLayout>

                    <VerticalStackLayout Grid.Column="1" Spacing="4">
                        <Label Text="Ð¦ÐµÐ½Ð° Ð´Ð¾" Style="{StaticResource MutedText}"/>
                        <Entry x:Name="MaxPriceEntry" Keyboard="Numeric" Style="{StaticResource Input}" HeightRequest="44"/>
                    </VerticalStackLayout>

                    <VerticalStackLayout Grid.Column="2" Spacing="4">
                        <Label Text="Ð ÐµÐ¹Ñ‚Ð¸Ð½Ð³ Ð¾Ñ‚" Style="{StaticResource MutedText}"/>
                        <Entry x:Name="MinRatingEntry" Keyboard="Numeric" Style="{StaticResource Input}" HeightRequest="44"/>
                    </VerticalStackLayout>
                </Grid>


                <Button Text="Ð¤Ð¸Ð»ÑŒÑ‚Ñ€"
                        Style="{StaticResource PrimaryButton}"
                        Clicked="OnFilterClicked"/>
            </VerticalStackLayout>
        </Border>

        <!-- Ð¡Ð¿Ð¸ÑÐ¾Ðº (ÑÐºÑ€Ð¾Ð»Ð»Ð¸Ñ‚ÑÑ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð¾Ð½) -->
        <CollectionView Grid.Row="2"
                        x:Name="AdsCollectionView"
                        SelectionMode="Single"
                        SelectionChanged="OnAdSelected">

            <CollectionView.ItemTemplate>
                <DataTemplate>
                    <Border Style="{StaticResource Card}" Margin="0,0,0,10">
                        <Grid ColumnDefinitions="80,*" ColumnSpacing="12">

                            <!-- Ð¤Ð¸ÐºÑ Ð¼ÐµÑÑ‚Ð¾ Ð¿Ð¾Ð´ Ñ„Ð¾Ñ‚Ð¾ -->
                            <Border BackgroundColor="{StaticResource BrandOrangeSoft}"
                                    Stroke="{StaticResource BorderSoft}"
                                    StrokeThickness="1"
                                    HeightRequest="80"
                                    WidthRequest="80">
                                <Border.StrokeShape>
                                    <RoundRectangle CornerRadius="16"/>
                                </Border.StrokeShape>
                                <Image Source="{Binding PhotoPath}" Aspect="AspectFill"/>
                            </Border>

                            <VerticalStackLayout Grid.Column="1" Spacing="4">

                                <Label Text="{Binding Title}"
                                       FontAttributes="Bold"
                                       FontSize="16"
                                       LineBreakMode="TailTruncation"/>

                                <Label Text="{Binding Category}" Style="{StaticResource MutedText}"/>
                                <Label Text="{Binding Area, StringFormat='Ð Ð°Ð¹Ð¾Ð½: {0}'}" Style="{StaticResource MutedText}"/>

                                <Grid ColumnDefinitions="*,Auto" Margin="0,6,0,0">
                                    <Label Text="{Binding Price, StringFormat='Ð¦ÐµÐ½Ð°: {0:F0} â‚½'}"
                                           FontAttributes="Bold" />
                                    <Label Grid.Column="1"
                                           Text="{Binding ViewsCount, StringFormat='ðŸ‘ {0}'}"
                                           Style="{StaticResource MutedText}"
                                           HorizontalOptions="End"/>
                                </Grid>

                                <Label Text="{Binding Description}"
                                       Style="{StaticResource BodyText}"
                                       LineBreakMode="TailTruncation"
                                       MaxLines="2"/>

                                <!-- ÐšÐ½Ð¾Ð¿ÐºÐ¸ ÐºÐ°Ðº Ñƒ Ñ‚ÐµÐ±Ñ Ð² ÑÑ‚Ð°Ñ€Ð¾Ð¼ AdsList -->
                                <HorizontalStackLayout Spacing="8" Margin="0,8,0,0">
                                    <Button Text="Ð—Ð°ÐºÐ°Ð·Ð°Ñ‚ÑŒ" Style="{StaticResource PrimaryButton}" Clicked="OnRequestClicked"/>
                                    <Button Text="Ð ÐµÐ´Ð°ÐºÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ" Style="{StaticResource GhostButton}" Clicked="OnEditClicked"/>
                                    <Button Text="Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ" Style="{StaticResource GhostButton}" Clicked="OnDeleteClicked"/>
                                </HorizontalStackLayout>

                            </VerticalStackLayout>

                        </Grid>
                    </Border>
                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>
    </Grid>
</ContentPage>
